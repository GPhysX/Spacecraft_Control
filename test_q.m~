commands = {[0 0 0]'; [70 70 70]'; [-70 -70 -70]';[0 0 0]'};
times = 1*[9.99, 50, 90, 150];
fig = 1;
% @f(x,y) = y;
% 
% %% PD, quaternions, no timesep
% s = spacecraft_q;
% c = pd_q;
% c.kp = 5*c.kp;
% run(s, c, commands, times, @f, 1);

%% NDI, quaternions, no timesep
s = spacecraft_q;
s.dt = 0.01;
c.kp = .1*c.kp;
run(s, pd_q, commands, times, indi_q, 100, fig);
%% NDI, euler, no timesep
s = spacecraft;
c = pd;
c.kp = 5*c.kp;
run(s, c, commands, times, ndi, 1, fig);

%% NDI, quaternions, timesep
s = spacecraft_q;
c = pd_q;
c.kp = .2*c.kp;
run(s, c, commands, 2*times, ndi_q, 10, fig);

%% NDI, euler angles, timesep
s = spacecraft;
c = pd;
c.kp = .15*c.kp;
run(s, c, commands, 2*times, ndi, 10, fig);

